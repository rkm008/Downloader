import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCB0aW1lICAjIEZvciBhbmltYXRpb24gZGVsYXkKCiMgQ29sb3JzCkdSRUVOID0gIlwwMzNbMzJtIgpZRUxMT1cgPSAiXDAzM1szM20iCkJMVUUgPSAiXDAzM1szNG0iCkNZQU4gPSAiXDAzM1szNm0iClJFRCA9ICJcMDMzWzMxbSIKQk9MRCA9ICJcMDMzWzFtIgpSRVNFVCA9ICJcMDMzWzBtIgoKIyBTZXQgZG93bmxvYWQgZGlyZWN0b3J5CkRPV05MT0FEX0RJUiA9IG9zLnBhdGguZXhwYW5kdXNlcigifi9zdG9yYWdlL3NoYXJlZC9Eb3dubG9hZCIpCgojIEZ1bmN0aW9uIHRvIGRpc3BsYXkgYW5pbWF0ZWQgQVNDSUkgYmFubmVyCmRlZiBkaXNwbGF5X2Jhbm5lcigpOgogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBiYW5uZXJfbGluZXMgPSBbCiAgICAgICAgZiJ7Q1lBTn17Qk9MRH0iLAogICAgICAgICIgICAgICAgICAgX19fX19fXyAgICAgICAgIF9fXyAgX19fXyAgICAgICBfX19fICAgIF9fX18gICIsCiAgICAgICAgIiAgICAgICAgIHxfICAgX18gXFwgICAgICAgfF8gIHx8XyAgX3wgICAgIHxfICAgXFwgIC8gICBffCAiLAogICAgICAgICIgICAgICAgICAgIHwgfF9fKSB8ICAgICAgICB8IHxfLyAvICAgICAgICAgfCAgIFxcLyAgIHwgICAiLAogICAgICAgICIgICAgICAgICAgIHwgIF9fIC8gICAgICAgICB8ICBfXycuICAgICAgICAgfCB8XFwgIC98IHwgICAiLAogICAgICAgICIgICAgICAgICAgX3wgfCAgXFwgXFxfICBfICAgX3wgfCAgXFwgXFxfICBfICAgX3wgfF9cXC8gfCB8XyAgIiwKICAgICAgICAiICAgICAgICB8X19fX3wgfF9fX3woXykgfF9fX198IHxfX198KF8pIHxfX19fX3wgIHxfX19ffCAiLAogICAgICAgIFJFU0VUCiAgICBdCiAgICBmb3IgbGluZSBpbiBiYW5uZXJfbGluZXM6CiAgICAgICAgcHJpbnQobGluZSkKICAgICAgICB0aW1lLnNsZWVwKDAuMSkKCmRlZiBtYWluKCk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIGRpc3BsYXlfYmFubmVyKCkKICAgICAgICB2aWRlb191cmwgPSBpbnB1dChmIlxu8J+TjCB7Qk9MRH1FbnRlciBZb3VUdWJlIFVSTDp7UkVTRVR9ICIpCgogICAgICAgIHByaW50KGYiXG57QkxVRX17Qk9MRH3wn5SNIENoZWNraW5nIGF2YWlsYWJsZSBxdWFsaXR5IG9wdGlvbnMuLi57UkVTRVR9IikKICAgICAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihbInl0LWRscCIsICItRiIsIHZpZGVvX3VybF0sIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKICAgICAgICBmb3JtYXRzID0gcmVzdWx0LnN0ZG91dAoKICAgICAgICBzZWVuID0ge30KICAgICAgICBpZiAiMzYwIiBpbiBmb3JtYXRzOiBzZWVuWyIzNjBwIl0gPSBUcnVlCiAgICAgICAgaWYgIjQ4MCIgaW4gZm9ybWF0czogc2VlblsiNDgwcCJdID0gVHJ1ZQogICAgICAgIGlmICI3MjAiIGluIGZvcm1hdHM6IHNlZW5bIjcyMHAiXSA9IFRydWUKICAgICAgICBpZiAiMTA4MCIgaW4gZm9ybWF0czogc2VlblsiMTA4MHAiXSA9IFRydWUKICAgICAgICBpZiAiMTQ0MCIgaW4gZm9ybWF0czogc2VlblsiMksiXSA9IFRydWUKICAgICAgICBpZiAiMjE2MCIgaW4gZm9ybWF0czogc2VlblsiNEsiXSA9IFRydWUKICAgICAgICBpZiAiNDMyMCIgaW4gZm9ybWF0czogc2VlblsiOEsiXSA9IFRydWUKCiAgICAgICAgb3JkZXJlZCA9IFsiMzYwcCIsICI0ODBwIiwgIjcyMHAiLCAiMTA4MHAiLCAiMksiLCAiNEsiLCAiOEsiXQogICAgICAgIG9wdGlvbnMgPSBbXQoKICAgICAgICBwcmludChmIlxue1lFTExPV317Qk9MRH3wn5O6IEF2YWlsYWJsZSBWaWRlbyBRdWFsaXRpZXM6e1JFU0VUfSIpCiAgICAgICAgcHJpbnQoIiAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQIikKICAgICAgICBpID0gMQogICAgICAgIGZvciBxIGluIG9yZGVyZWQ6CiAgICAgICAgICAgIGlmIHEgaW4gc2VlbjoKICAgICAgICAgICAgICAgIGVtb2ppID0gZiJ7aX1cdTIwZTMiCiAgICAgICAgICAgICAgICBsYWJlbCA9IHEKICAgICAgICAgICAgICAgIGlmIHEgPT0gIjJLIjogbGFiZWwgPSAiMksgKDE0NDBwKSIKICAgICAgICAgICAgICAgIGVsaWYgcSA9PSAiNEsiOiBsYWJlbCA9ICI0SyAoMjE2MHApIgogICAgICAgICAgICAgICAgZWxpZiBxID09ICI4SyI6IGxhYmVsID0gIjhLICg0MzIwcCkiCiAgICAgICAgICAgICAgICBwcmludChmIiAg4pSCICB7ZW1vaml9ICB7bGFiZWw6PDI4feKUgiIpCiAgICAgICAgICAgICAgICBvcHRpb25zLmFwcGVuZChxKQogICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgZW1vamkgPSBmIntpfVx1MjBlMyIKICAgICAgICBwcmludChmIiAg4pSCICB7ZW1vaml9ICBNUDMgKEF1ZGlvIE9ubHkpICAgICAgICAgICAg4pSCIikKICAgICAgICBvcHRpb25zLmFwcGVuZCgiTVAzIikKICAgICAgICBwcmludCgiICDilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJgiKQoKICAgICAgICBwcmludChmIlxue0NZQU59e0JPTER98J+OryBUaXA6e1JFU0VUfSBVc2UgZm9ybWF0IGNvZGVzIGxpc3RlZCBhYm92ZSBpZiB5b3Ugd2FudCBjdXN0b20gY29udHJvbC4iKQogICAgICAgIHByaW50KGYie1lFTExPV33ihLnvuI8gIFlvdSdsbCBzdGlsbCBnZXQgcXVhbGl0eSBvcHRpb25zIGJlbG93IGZvciBlYXN5IHVzZS57UkVTRVR9IikKCiAgICAgICAgY2hvaWNlID0gaW5wdXQoZiJcbvCflLkge0JPTER9U2VsZWN0IGFuIG9wdGlvbiAoMS17bGVuKG9wdGlvbnMpfSk6e1JFU0VUfSAiKQogICAgICAgIHRyeToKICAgICAgICAgICAgaW5kZXggPSBpbnQoY2hvaWNlKSAtIDEKICAgICAgICAgICAgc2VsZWN0ZWQgPSBvcHRpb25zW2luZGV4XQogICAgICAgIGV4Y2VwdCAoVmFsdWVFcnJvciwgSW5kZXhFcnJvcik6CiAgICAgICAgICAgIHByaW50KGYie1JFRH3inYwgSW52YWxpZCBzZWxlY3Rpb24he1JFU0VUfSIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBzZWxlY3RlZCA9PSAiMzYwcCI6CiAgICAgICAgICAgIGZtdCA9ICJiZXN0dmlkZW9baGVpZ2h0PD0zNjBdK2Jlc3RhdWRpby9iZXN0W2hlaWdodDw9MzYwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICI0ODBwIjoKICAgICAgICAgICAgZm10ID0gImJlc3R2aWRlb1toZWlnaHQ8PTQ4MF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD00ODBdIgogICAgICAgIGVsaWYgc2VsZWN0ZWQgPT0gIjcyMHAiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9NzIwXStiZXN0YXVkaW8vYmVzdFtoZWlnaHQ8PTcyMF0iCiAgICAgICAgZWxpZiBzZWxlY3RlZCA9PSAiMTA4MHAiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9MTA4MF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD0xMDgwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICIySyI6CiAgICAgICAgICAgIGZtdCA9ICJiZXN0dmlkZW9baGVpZ2h0PD0xNDQwXStiZXN0YXVkaW8vYmVzdFtoZWlnaHQ8PTE0NDBdIgogICAgICAgIGVsaWYgc2VsZWN0ZWQgPT0gIjRLIjoKICAgICAgICAgICAgZm10ID0gImJlc3R2aWRlb1toZWlnaHQ8PTIxNjBdK2Jlc3RhdWRpby9iZXN0W2hlaWdodDw9MjE2MF0iCiAgICAgICAgZWxpZiBzZWxlY3RlZCA9PSAiOEsiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9NDMyMF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD00MzIwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICJNUDMiOgogICAgICAgICAgICBmbXQgPSAiYmVzdGF1ZGlvIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYie1JFRH3inYwgSW52YWxpZCBzZWxlY3Rpb24he1JFU0VUfSIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBwcmludChmIlxue0NZQU598J+TpSBEb3dubG9hZGluZyBpbiBzZWxlY3RlZCBxdWFsaXR5Li4ue1JFU0VUfSIpCiAgICAgICAgaWYgc2VsZWN0ZWQgPT0gIk1QMyI6CiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKFsKICAgICAgICAgICAgICAgICJ5dC1kbHAiLCAiLWYiLCBmbXQsICIteCIsICItLWF1ZGlvLWZvcm1hdCIsICJtcDMiLAogICAgICAgICAgICAgICAgIi1vIiwgZiJ7RE9XTkxPQURfRElSfS8lKHRpdGxlKXMuJShleHQpcyIsIHZpZGVvX3VybAogICAgICAgICAgICBdKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKFsKICAgICAgICAgICAgICAgICJ5dC1kbHAiLCAiLWYiLCBmbXQsICItLW1lcmdlLW91dHB1dC1mb3JtYXQiLCAibXA0IiwKICAgICAgICAgICAgICAgICItbyIsIGYie0RPV05MT0FEX0RJUn0vJSh0aXRsZSlzLiUoZXh0KXMiLCB2aWRlb191cmwKICAgICAgICAgICAgXSkKCiAgICAgICAgcHJpbnQoZiJcbntHUkVFTn3inIUgRG93bmxvYWQgY29tcGxldGVkIXtSRVNFVH0iKQogICAgICAgIHByaW50KGYie0JPTER98J+TgiBGaWxlIHNhdmVkIHRvOiB7RE9XTkxPQURfRElSfXtSRVNFVH1cbiIpCgogICAgICAgIGNvbnQgPSBpbnB1dChmIlxu8J+UhCB7Qk9MRH1EbyB5b3Ugd2FudCB0byBkb3dubG9hZCBtb3JlPyAoeS9uKTp7UkVTRVR9ICIpCiAgICAgICAgaWYgY29udC5sb3dlcigpICE9ICd5JzoKICAgICAgICAgICAgYnJlYWsKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCk='))
