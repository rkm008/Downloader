import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCB0aW1lICAjIEZvciBhbmltYXRpb24gZGVsYXkKCiMgQ29sb3JzCkdSRUVOID0gIlwwMzNbMzJtIgpZRUxMT1cgPSAiXDAzM1szM20iCkJMVUUgPSAiXDAzM1szNG0iCkNZQU4gPSAiXDAzM1szNm0iClJFRCA9ICJcMDMzWzMxbSIKQk9MRCA9ICJcMDMzWzFtIgpSRVNFVCA9ICJcMDMzWzBtIgoKIyBTZXQgZG93bmxvYWQgZGlyZWN0b3J5CkRPV05MT0FEX0RJUiA9IG9zLnBhdGguZXhwYW5kdXNlcigifi9zdG9yYWdlL3NoYXJlZC9Eb3dubG9hZCIpCgojIEZ1bmN0aW9uIHRvIGRpc3BsYXkgYW5pbWF0ZWQgQVNDSUkgYmFubmVyCmRlZiBkaXNwbGF5X2Jhbm5lcigpOgogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBiYW5uZXJfbGluZXMgPSBbCiAgICAgICAgZiJ7Q1lBTn17Qk9MRH0iLAogICAgICAgICIgICAgICAgICAgX19fX19fXyAgICAgICAgIF9fXyAgX19fXyAgICAgICBfX19fICAgIF9fX18gICIsCiAgICAgICAgIiAgICAgICAgIHxfICAgX18gXFwgICAgICAgfF8gIHx8XyAgX3wgICAgIHxfICAgXFwgIC8gICBffCAiLAogICAgICAgICIgICAgICAgICAgIHwgfF9fKSB8ICAgICAgICB8IHxfLyAvICAgICAgICAgfCAgIFxcLyAgIHwgICAiLAogICAgICAgICIgICAgICAgICAgIHwgIF9fIC8gICAgICAgICB8ICBfXycuICAgICAgICAgfCB8XFwgIC98IHwgICAiLAogICAgICAgICIgICAgICAgICAgX3wgfCAgXFwgXFxfICBfICAgX3wgfCAgXFwgXFxfICBfICAgX3wgfF9cXC8gfCB8XyAgIiwKICAgICAgICAiICAgICAgICB8X19fX3wgfF9fX3woXykgfF9fX198IHxfX198KF8pIHxfX19fX3wgIHxfX19ffCAiLAogICAgICAgIFJFU0VUCiAgICBdCiAgICBmb3IgbGluZSBpbiBiYW5uZXJfbGluZXM6CiAgICAgICAgcHJpbnQobGluZSkKICAgICAgICB0aW1lLnNsZWVwKDAuMSkKCmRlZiBtYWluKCk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIGRpc3BsYXlfYmFubmVyKCkKICAgICAgICB2aWRlb191cmwgPSBpbnB1dChmIlxu8J+TjCB7Qk9MRH1FbnRlciBWaWRlbyBVUkw6e1JFU0VUfSAiKQoKICAgICAgICBwcmludChmIlxue0JMVUV9e0JPTER98J+UjSBDaGVja2luZyBhdmFpbGFibGUgcXVhbGl0eSBvcHRpb25zLi4ue1JFU0VUfSIpCiAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oWyJ5dC1kbHAiLCAiLUYiLCB2aWRlb191cmxdLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCiAgICAgICAgZm9ybWF0cyA9IHJlc3VsdC5zdGRvdXQKCiAgICAgICAgc2VlbiA9IHt9CiAgICAgICAgaWYgIjM2MCIgaW4gZm9ybWF0czogc2VlblsiMzYwcCJdID0gVHJ1ZQogICAgICAgIGlmICI0ODAiIGluIGZvcm1hdHM6IHNlZW5bIjQ4MHAiXSA9IFRydWUKICAgICAgICBpZiAiNzIwIiBpbiBmb3JtYXRzOiBzZWVuWyI3MjBwIl0gPSBUcnVlCiAgICAgICAgaWYgIjEwODAiIGluIGZvcm1hdHM6IHNlZW5bIjEwODBwIl0gPSBUcnVlCiAgICAgICAgaWYgIjE0NDAiIGluIGZvcm1hdHM6IHNlZW5bIjJLIl0gPSBUcnVlCiAgICAgICAgaWYgIjIxNjAiIGluIGZvcm1hdHM6IHNlZW5bIjRLIl0gPSBUcnVlCiAgICAgICAgaWYgIjQzMjAiIGluIGZvcm1hdHM6IHNlZW5bIjhLIl0gPSBUcnVlCgogICAgICAgIG9yZGVyZWQgPSBbIjM2MHAiLCAiNDgwcCIsICI3MjBwIiwgIjEwODBwIiwgIjJLIiwgIjRLIiwgIjhLIl0KICAgICAgICBvcHRpb25zID0gW10KCiAgICAgICAgcHJpbnQoZiJcbntZRUxMT1d9e0JPTER98J+TuiBBdmFpbGFibGUgVmlkZW8gUXVhbGl0aWVzOntSRVNFVH0iKQogICAgICAgIHByaW50KCIgIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkCIpCiAgICAgICAgaSA9IDEKICAgICAgICBmb3IgcSBpbiBvcmRlcmVkOgogICAgICAgICAgICBpZiBxIGluIHNlZW46CiAgICAgICAgICAgICAgICBlbW9qaSA9IGYie2l9XHUyMGUzIgogICAgICAgICAgICAgICAgbGFiZWwgPSBxCiAgICAgICAgICAgICAgICBpZiBxID09ICIySyI6IGxhYmVsID0gIjJLICgxNDQwcCkiCiAgICAgICAgICAgICAgICBlbGlmIHEgPT0gIjRLIjogbGFiZWwgPSAiNEsgKDIxNjBwKSIKICAgICAgICAgICAgICAgIGVsaWYgcSA9PSAiOEsiOiBsYWJlbCA9ICI4SyAoNDMyMHApIgogICAgICAgICAgICAgICAgcHJpbnQoZiIgIOKUgiAge2Vtb2ppfSAge2xhYmVsOjwyOH3ilIIiKQogICAgICAgICAgICAgICAgb3B0aW9ucy5hcHBlbmQocSkKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgIGVtb2ppID0gZiJ7aX1cdTIwZTMiCiAgICAgICAgcHJpbnQoZiIgIOKUgiAge2Vtb2ppfSAgTVAzIChBdWRpbyBPbmx5KSAgICAgICAgICAgIOKUgiIpCiAgICAgICAgb3B0aW9ucy5hcHBlbmQoIk1QMyIpCiAgICAgICAgcHJpbnQoIiAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYIikKCiAgICAgICAgcHJpbnQoZiJcbntDWUFOfXtCT0xEffCfjq8gVGlwOntSRVNFVH0gVXNlIGZvcm1hdCBjb2RlcyBsaXN0ZWQgYWJvdmUgaWYgeW91IHdhbnQgY3VzdG9tIGNvbnRyb2wuIikKICAgICAgICBwcmludChmIntZRUxMT1d94oS577iPICBZb3UnbGwgc3RpbGwgZ2V0IHF1YWxpdHkgb3B0aW9ucyBiZWxvdyBmb3IgZWFzeSB1c2Uue1JFU0VUfSIpCgogICAgICAgIGNob2ljZSA9IGlucHV0KGYiXG7wn5S5IHtCT0xEfVNlbGVjdCBhbiBvcHRpb24gKDEte2xlbihvcHRpb25zKX0pOntSRVNFVH0gIikKICAgICAgICB0cnk6CiAgICAgICAgICAgIGluZGV4ID0gaW50KGNob2ljZSkgLSAxCiAgICAgICAgICAgIHNlbGVjdGVkID0gb3B0aW9uc1tpbmRleF0KICAgICAgICBleGNlcHQgKFZhbHVlRXJyb3IsIEluZGV4RXJyb3IpOgogICAgICAgICAgICBwcmludChmIntSRUR94p2MIEludmFsaWQgc2VsZWN0aW9uIXtSRVNFVH0iKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgc2VsZWN0ZWQgPT0gIjM2MHAiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9MzYwXStiZXN0YXVkaW8vYmVzdFtoZWlnaHQ8PTM2MF0iCiAgICAgICAgZWxpZiBzZWxlY3RlZCA9PSAiNDgwcCI6CiAgICAgICAgICAgIGZtdCA9ICJiZXN0dmlkZW9baGVpZ2h0PD00ODBdK2Jlc3RhdWRpby9iZXN0W2hlaWdodDw9NDgwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICI3MjBwIjoKICAgICAgICAgICAgZm10ID0gImJlc3R2aWRlb1toZWlnaHQ8PTcyMF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD03MjBdIgogICAgICAgIGVsaWYgc2VsZWN0ZWQgPT0gIjEwODBwIjoKICAgICAgICAgICAgZm10ID0gImJlc3R2aWRlb1toZWlnaHQ8PTEwODBdK2Jlc3RhdWRpby9iZXN0W2hlaWdodDw9MTA4MF0iCiAgICAgICAgZWxpZiBzZWxlY3RlZCA9PSAiMksiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9MTQ0MF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD0xNDQwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICI0SyI6CiAgICAgICAgICAgIGZtdCA9ICJiZXN0dmlkZW9baGVpZ2h0PD0yMTYwXStiZXN0YXVkaW8vYmVzdFtoZWlnaHQ8PTIxNjBdIgogICAgICAgIGVsaWYgc2VsZWN0ZWQgPT0gIjhLIjoKICAgICAgICAgICAgZm10ID0gImJlc3R2aWRlb1toZWlnaHQ8PTQzMjBdK2Jlc3RhdWRpby9iZXN0W2hlaWdodDw9NDMyMF0iCiAgICAgICAgZWxpZiBzZWxlY3RlZCA9PSAiTVAzIjoKICAgICAgICAgICAgZm10ID0gImJlc3RhdWRpbyIKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChmIntSRUR94p2MIEludmFsaWQgc2VsZWN0aW9uIXtSRVNFVH0iKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgcHJpbnQoZiJcbntDWUFOffCfk6UgRG93bmxvYWRpbmcgaW4gc2VsZWN0ZWQgcXVhbGl0eS4uLntSRVNFVH0iKQogICAgICAgIGlmIHNlbGVjdGVkID09ICJNUDMiOgogICAgICAgICAgICBzdWJwcm9jZXNzLnJ1bihbCiAgICAgICAgICAgICAgICAieXQtZGxwIiwgIi1mIiwgZm10LCAiLXgiLCAiLS1hdWRpby1mb3JtYXQiLCAibXAzIiwKICAgICAgICAgICAgICAgICItbyIsIGYie0RPV05MT0FEX0RJUn0vJSh0aXRsZSlzLiUoZXh0KXMiLCB2aWRlb191cmwKICAgICAgICAgICAgXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdWJwcm9jZXNzLnJ1bihbCiAgICAgICAgICAgICAgICAieXQtZGxwIiwgIi1mIiwgZm10LCAiLS1tZXJnZS1vdXRwdXQtZm9ybWF0IiwgIm1wNCIsCiAgICAgICAgICAgICAgICAiLW8iLCBmIntET1dOTE9BRF9ESVJ9LyUodGl0bGUpcy4lKGV4dClzIiwgdmlkZW9fdXJsCiAgICAgICAgICAgIF0pCgogICAgICAgIHByaW50KGYiXG57R1JFRU594pyFIERvd25sb2FkIGNvbXBsZXRlZCF7UkVTRVR9IikKICAgICAgICBwcmludChmIntCT0xEffCfk4IgRmlsZSBzYXZlZCB0bzoge0RPV05MT0FEX0RJUn17UkVTRVR9XG4iKQoKICAgICAgICBjb250ID0gaW5wdXQoZiJcbvCflIQge0JPTER9RG8geW91IHdhbnQgdG8gZG93bmxvYWQgbW9yZT8gKHkvbik6e1JFU0VUfSAiKQogICAgICAgIGlmIGNvbnQubG93ZXIoKSAhPSAneSc6CiAgICAgICAgICAgIGJyZWFrCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigp'))