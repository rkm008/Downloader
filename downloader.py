import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCB0aW1lICAjIEZvciBhbmltYXRpb24gZGVsYXkKCiMgQ29sb3JzCkdSRUVOID0gIlwwMzNbMzJtIgpZRUxMT1cgPSAiXDAzM1szM20iCkJMVUUgPSAiXDAzM1szNG0iCkNZQU4gPSAiXDAzM1szNm0iClJFRCA9ICJcMDMzWzMxbSIKQk9MRCA9ICJcMDMzWzFtIgpSRVNFVCA9ICJcMDMzWzBtIgoKIyBTZXQgZG93bmxvYWQgZGlyZWN0b3J5CkRPV05MT0FEX0RJUiA9IG9zLnBhdGguZXhwYW5kdXNlcigifi9zdG9yYWdlL3NoYXJlZC9Eb3dubG9hZCIpCgojIEZ1bmN0aW9uIHRvIGRpc3BsYXkgYW5pbWF0ZWQgQVNDSUkgYmFubmVyCmRlZiBkaXNwbGF5X2Jhbm5lcigpOgogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBiYW5uZXJfbGluZXMgPSBbCiAgICAgICAgZiJ7Q1lBTn17Qk9MRH0iLAogICAgICAgICIgICAgICAgICAgX19fX19fXyAgICAgICAgIF9fXyAgX19fXyAgICAgICBfX19fICAgIF9fX18gICIsCiAgICAgICAgIiAgICAgICAgIHxfICAgX18gXFwgICAgICAgfF8gIHx8XyAgX3wgICAgIHxfICAgXFwgIC8gICBffCAiLAogICAgICAgICIgICAgICAgICAgIHwgfF9fKSB8ICAgICAgICB8IHxfLyAvICAgICAgICAgfCAgIFxcLyAgIHwgICAiLAogICAgICAgICIgICAgICAgICAgIHwgIF9fIC8gICAgICAgICB8ICBfXycuICAgICAgICAgfCB8XFwgIC98IHwgICAiLAogICAgICAgICIgICAgICAgICAgX3wgfCAgXFwgXFxfICBfICAgX3wgfCAgXFwgXFxfICBfICAgX3wgfF9cXC8gfCB8XyAgIiwKICAgICAgICAiICAgICAgICB8X19fX3wgfF9fX3woXykgfF9fX198IHxfX198KF8pIHxfX19fX3wgIHxfX19ffCAiLAogICAgICAgIFJFU0VUCiAgICBdCiAgICBmb3IgbGluZSBpbiBiYW5uZXJfbGluZXM6CiAgICAgICAgcHJpbnQobGluZSkKICAgICAgICB0aW1lLnNsZWVwKDAuMSkKCmRlZiBtYWluKCk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIGRpc3BsYXlfYmFubmVyKCkKICAgICAgICB2aWRlb191cmwgPSBpbnB1dChmIlxu8J+TjCB7Qk9MRH1FbnRlciBWaWRlbyBVUkw6e1JFU0VUfSAiKQoKICAgICAgICBwcmludChmIlxue0JMVUV9e0JPTER98J+UjSBDaGVja2luZyBhdmFpbGFibGUgcXVhbGl0eSBvcHRpb25zLi4ue1JFU0VUfSIpCiAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oWyJ5dC1kbHAiLCAiLUYiLCB2aWRlb191cmxdLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCiAgICAgICAgZm9ybWF0cyA9IHJlc3VsdC5zdGRvdXQKICAgICAgICBmb3JtYXRfc2l6ZXMgPSB7fQoKICAgICAgICBmb3IgbGluZSBpbiBmb3JtYXRzLnNwbGl0bGluZXMoKToKICAgICAgICAgICAgaWYgYW55KHggaW4gbGluZSBmb3IgeCBpbiBbIjM2MCIsICI0ODAiLCAiNzIwIiwgIjEwODAiLCAiMTQ0MCIsICIyMTYwIiwgIjQzMjAiXSk6CiAgICAgICAgICAgICAgICBwYXJ0cyA9IGxpbmUuc3BsaXQoKQogICAgICAgICAgICAgICAgaWYgbGVuKHBhcnRzKSA+PSA1OgogICAgICAgICAgICAgICAgICAgIHJlc29sdXRpb24gPSBwYXJ0c1syXQogICAgICAgICAgICAgICAgICAgIHNpemUgPSAiVW5rbm93biIKICAgICAgICAgICAgICAgICAgICBmb3IgcCBpbiBwYXJ0czoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgcC5lbmRzd2l0aCgiTWlCIikgb3IgcC5lbmRzd2l0aCgiR2lCIik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplID0gcAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAiMzYwIiBpbiByZXNvbHV0aW9uOiBmb3JtYXRfc2l6ZXNbIjM2MHAiXSA9IHNpemUKICAgICAgICAgICAgICAgICAgICBlbGlmICI0ODAiIGluIHJlc29sdXRpb246IGZvcm1hdF9zaXplc1siNDgwcCJdID0gc2l6ZQogICAgICAgICAgICAgICAgICAgIGVsaWYgIjcyMCIgaW4gcmVzb2x1dGlvbjogZm9ybWF0X3NpemVzWyI3MjBwIl0gPSBzaXplCiAgICAgICAgICAgICAgICAgICAgZWxpZiAiMTA4MCIgaW4gcmVzb2x1dGlvbjogZm9ybWF0X3NpemVzWyIxMDgwcCJdID0gc2l6ZQogICAgICAgICAgICAgICAgICAgIGVsaWYgIjE0NDAiIGluIHJlc29sdXRpb246IGZvcm1hdF9zaXplc1siMksiXSA9IHNpemUKICAgICAgICAgICAgICAgICAgICBlbGlmICIyMTYwIiBpbiByZXNvbHV0aW9uOiBmb3JtYXRfc2l6ZXNbIjRLIl0gPSBzaXplCiAgICAgICAgICAgICAgICAgICAgZWxpZiAiNDMyMCIgaW4gcmVzb2x1dGlvbjogZm9ybWF0X3NpemVzWyI4SyJdID0gc2l6ZQoKICAgICAgICBzZWVuID0ge30KICAgICAgICBpZiAiMzYwIiBpbiBmb3JtYXRzOiBzZWVuWyIzNjBwIl0gPSBUcnVlCiAgICAgICAgaWYgIjQ4MCIgaW4gZm9ybWF0czogc2VlblsiNDgwcCJdID0gVHJ1ZQogICAgICAgIGlmICI3MjAiIGluIGZvcm1hdHM6IHNlZW5bIjcyMHAiXSA9IFRydWUKICAgICAgICBpZiAiMTA4MCIgaW4gZm9ybWF0czogc2VlblsiMTA4MHAiXSA9IFRydWUKICAgICAgICBpZiAiMTQ0MCIgaW4gZm9ybWF0czogc2VlblsiMksiXSA9IFRydWUKICAgICAgICBpZiAiMjE2MCIgaW4gZm9ybWF0czogc2VlblsiNEsiXSA9IFRydWUKICAgICAgICBpZiAiNDMyMCIgaW4gZm9ybWF0czogc2VlblsiOEsiXSA9IFRydWUKCiAgICAgICAgb3JkZXJlZCA9IFsiMzYwcCIsICI0ODBwIiwgIjcyMHAiLCAiMTA4MHAiLCAiMksiLCAiNEsiLCAiOEsiXQogICAgICAgIG9wdGlvbnMgPSBbXQoKICAgICAgICBwcmludChmIlxue1lFTExPV317Qk9MRH3wn5O6IEF2YWlsYWJsZSBWaWRlbyBRdWFsaXRpZXM6e1JFU0VUfSIpCgogICAgICAgICMgRGV0ZXJtaW5lIGR5bmFtaWMgd2lkdGggYmFzZWQgb24gdGhlIGxvbmdlc3Qgc2l6ZSBzdHJpbmcKICAgICAgICBtYXhfc2l6ZV9sZW4gPSBtYXgobGVuKHNpemUpIGZvciBzaXplIGluIGZvcm1hdF9zaXplcy52YWx1ZXMoKSBpZiBzaXplKSBpZiBmb3JtYXRfc2l6ZXMgZWxzZSA5CiAgICAgICAgc2l6ZV9jb2xfd2lkdGggPSBtYXgobWF4X3NpemVfbGVuLCA5KSArIDIgICMgUGFkZGluZyBmb3Igc3BhY2luZwogICAgICAgIHRvdGFsX2JveF93aWR0aCA9IDI4ICsgc2l6ZV9jb2xfd2lkdGgKCiAgICAgICAgcHJpbnQoZiIgIOKUjHsn4pSAJyAqIHRvdGFsX2JveF93aWR0aH3ilJAiKQogICAgICAgIGkgPSAxCiAgICAgICAgZm9yIHEgaW4gb3JkZXJlZDoKICAgICAgICAgICAgaWYgcSBpbiBzZWVuOgogICAgICAgICAgICAgICAgZW1vamkgPSBmIntpfVx1MjBlMyIKICAgICAgICAgICAgICAgIGxhYmVsID0gcQogICAgICAgICAgICAgICAgaWYgcSA9PSAiMksiOiBsYWJlbCA9ICIySyAoMTQ0MHApIgogICAgICAgICAgICAgICAgZWxpZiBxID09ICI0SyI6IGxhYmVsID0gIjRLICgyMTYwcCkiCiAgICAgICAgICAgICAgICBlbGlmIHEgPT0gIjhLIjogbGFiZWwgPSAiOEsgKDQzMjBwKSIKICAgICAgICAgICAgICAgIHNpemVfaW5mbyA9IGZvcm1hdF9zaXplcy5nZXQocSwgIlVua25vd24gU2l6ZSIpCiAgICAgICAgICAgICAgICBwcmludChmIiAg4pSCICB7ZW1vaml9ICB7bGFiZWw6PDE4fSBbe3NpemVfaW5mbzpee3NpemVfY29sX3dpZHRofX1dIOKUgiIpCiAgICAgICAgICAgICAgICBvcHRpb25zLmFwcGVuZChxKQogICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgZW1vamkgPSBmIntpfVx1MjBlMyIKICAgICAgICBwcmludChmIiAg4pSCICB7ZW1vaml9ICBNUDMgKEF1ZGlvIE9ubHkpeycgJyAqICh0b3RhbF9ib3hfd2lkdGggLSAyOCl9ICIpCiAgICAgICAgb3B0aW9ucy5hcHBlbmQoIk1QMyIpCiAgICAgICAgcHJpbnQoZiIgIOKUlHsn4pSAJyAqIHRvdGFsX2JveF93aWR0aH3ilJgiKQoKICAgICAgICBwcmludChmIlxue0NZQU59e0JPTER98J+OryBUaXA6e1JFU0VUfSBVc2UgZm9ybWF0IGNvZGVzIGxpc3RlZCBhYm92ZSBpZiB5b3Ugd2FudCBjdXN0b20gY29udHJvbC4iKQogICAgICAgIHByaW50KGYie1lFTExPV33ihLnvuI8gIFlvdSdsbCBzdGlsbCBnZXQgcXVhbGl0eSBvcHRpb25zIGJlbG93IGZvciBlYXN5IHVzZS57UkVTRVR9IikKCiAgICAgICAgY2hvaWNlID0gaW5wdXQoZiJcbvCflLkge0JPTER9U2VsZWN0IGFuIG9wdGlvbiAoMS17bGVuKG9wdGlvbnMpfSk6e1JFU0VUfSAiKQogICAgICAgIHRyeToKICAgICAgICAgICAgaW5kZXggPSBpbnQoY2hvaWNlKSAtIDEKICAgICAgICAgICAgc2VsZWN0ZWQgPSBvcHRpb25zW2luZGV4XQogICAgICAgIGV4Y2VwdCAoVmFsdWVFcnJvciwgSW5kZXhFcnJvcik6CiAgICAgICAgICAgIHByaW50KGYie1JFRH3inYwgSW52YWxpZCBzZWxlY3Rpb24he1JFU0VUfSIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBzZWxlY3RlZCA9PSAiMzYwcCI6CiAgICAgICAgICAgIGZtdCA9ICJiZXN0dmlkZW9baGVpZ2h0PD0zNjBdK2Jlc3RhdWRpby9iZXN0W2hlaWdodDw9MzYwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICI0ODBwIjoKICAgICAgICAgICAgZm10ID0gImJlc3R2aWRlb1toZWlnaHQ8PTQ4MF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD00ODBdIgogICAgICAgIGVsaWYgc2VsZWN0ZWQgPT0gIjcyMHAiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9NzIwXStiZXN0YXVkaW8vYmVzdFtoZWlnaHQ8PTcyMF0iCiAgICAgICAgZWxpZiBzZWxlY3RlZCA9PSAiMTA4MHAiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9MTA4MF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD0xMDgwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICIySyI6CiAgICAgICAgICAgIGZtdCA9ICJiZXN0dmlkZW9baGVpZ2h0PD0xNDQwXStiZXN0YXVkaW8vYmVzdFtoZWlnaHQ8PTE0NDBdIgogICAgICAgIGVsaWYgc2VsZWN0ZWQgPT0gIjRLIjoKICAgICAgICAgICAgZm10ID0gImJlc3R2aWRlb1toZWlnaHQ8PTIxNjBdK2Jlc3RhdWRpby9iZXN0W2hlaWdodDw9MjE2MF0iCiAgICAgICAgZWxpZiBzZWxlY3RlZCA9PSAiOEsiOgogICAgICAgICAgICBmbXQgPSAiYmVzdHZpZGVvW2hlaWdodDw9NDMyMF0rYmVzdGF1ZGlvL2Jlc3RbaGVpZ2h0PD00MzIwXSIKICAgICAgICBlbGlmIHNlbGVjdGVkID09ICJNUDMiOgogICAgICAgICAgICBmbXQgPSAiYmVzdGF1ZGlvIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYie1JFRH3inYwgSW52YWxpZCBzZWxlY3Rpb24he1JFU0VUfSIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBwcmludChmIlxue0NZQU598J+TpSBEb3dubG9hZGluZyBpbiBzZWxlY3RlZCBxdWFsaXR5Li4ue1JFU0VUfSIpCiAgICAgICAgaWYgc2VsZWN0ZWQgPT0gIk1QMyI6CiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKFsKICAgICAgICAgICAgICAgICJ5dC1kbHAiLCAiLWYiLCBmbXQsICIteCIsICItLWF1ZGlvLWZvcm1hdCIsICJtcDMiLAogICAgICAgICAgICAgICAgIi1vIiwgZiJ7RE9XTkxPQURfRElSfS8lKHRpdGxlKS44MHMuJShleHQpcyIsIHZpZGVvX3VybAogICAgICAgICAgICBdKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKFsKICAgICAgICAgICAgICAgICJ5dC1kbHAiLCAiLWYiLCBmbXQsICItLW1lcmdlLW91dHB1dC1mb3JtYXQiLCAibXA0IiwKICAgICAgICAgICAgICAgICItbyIsIGYie0RPV05MT0FEX0RJUn0vJSh0aXRsZSkuODBzLiUoZXh0KXMiLCB2aWRlb191cmwKICAgICAgICAgICAgXSkKCiAgICAgICAgcHJpbnQoZiJcbntHUkVFTn3inIUgRG93bmxvYWQgY29tcGxldGVkIXtSRVNFVH0iKQogICAgICAgIHByaW50KGYie0JPTER98J+TgiBGaWxlIHNhdmVkIHRvOiB7RE9XTkxPQURfRElSfXtSRVNFVH1cbiIpCgogICAgICAgIGNvbnQgPSBpbnB1dChmIlxu8J+UhCB7Qk9MRH1EbyB5b3Ugd2FudCB0byBkb3dubG9hZCBtb3JlPyAoeS9uKTp7UkVTRVR9ICIpCiAgICAgICAgaWYgY29udC5sb3dlcigpICE9ICd5JzoKICAgICAgICAgICAgYnJlYWsKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCk='))